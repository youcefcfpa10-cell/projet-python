<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø§Ù„Ø¥Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£ÙˆÙ„ - Ø¥Ù„Ù‚Ø§Ø¡ Ø§Ù„Ø¯Ø±Ø³</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@600;700&display=swap" rel="stylesheet">

<style>
body {
    margin: 0;
    font-family: 'Cairo', sans-serif;
    background: #D35400;
    text-align: center;
}

/* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ */
.header {
    display: flex;
    align-items: center;
    justify-content: center;
    background: #1E1E2F;
    padding: 10px 0;
    position: relative;
}

.header img {
    width: 40px;
    height: 40px;
    position: absolute;
    left: 20px;
}

.header h1 {
    color: white;
    font-size: 24px;
    font-weight: 700;
    margin: 0;
}

/* Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ */
.container {
    max-width: 950px;
    margin: 20px auto;
    background: #D35400;
    padding: 20px;
    border-radius: 10px;
}

/* Ø§Ù„Ø¹Ù†ÙˆØ§Ù† */
.container h2 {
    color: white;
    font-size: 22px;
    font-weight: bold;
    margin-bottom: 20px;
}

/* Ø¥Ø¯Ø®Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³ */
.lesson-title {
    margin-bottom: 20px;
}
.lesson-title label { color: white; font-weight: bold; font-size: 16px; margin-right: 10px; }
.lesson-title input { width: 60%; padding: 8px; font-size: 14px; }

/* Ø§Ù„Ø¬Ø¯ÙˆÙ„ */
table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
}
table th, table td {
    border: 1px solid white;
    padding: 8px;
    text-align: center;
    font-weight: bold;
}
table th {
    background-color: #1E1E2F;
    color: white;
}
input.mark-input {
    width: 60px;
    text-align: center;
}

/* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
.button-group {
    margin-top: 20px;
}
.btn {
    padding: 12px 20px;
    font-size: 14px;
    font-weight: bold;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    margin: 5px;
    color: white;
}
.save-btn { background-color: #28a745; }
.notes-btn { background-color: #4682B4; }
.exit-btn { background-color: #FF0000; }

/* Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª */
#notes-section {
    display: none;
    background: #F4A460;
    padding: 15px;
    margin-top: 20px;
    border-radius: 8px;
    text-align: right;
}
#notes-section textarea {
    width: 100%;
    height: 150px;
    font-size: 14px;
    padding: 8px;
}
</style>
</head>
<body>

<!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
<div class="header">
    <img src="images/ITP1.ICO" alt="Logo">
    <h1>Ø§Ù„Ø¥Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø£ÙˆÙ„ - Ø¥Ù„Ù‚Ø§Ø¡ Ø§Ù„Ø¯Ø±Ø³</h1>
</div>

<div class="container">
    <h2>Ø¥Ù„Ù‚Ø§Ø¡ Ø§Ù„Ø¯Ø±Ø³</h2>

    <!-- Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³ -->
    <div class="lesson-title">
        <label>Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯Ø±Ø³:</label>
        <input type="text" id="lesson-title">
    </div>

    <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„ØªÙ†Ù‚ÙŠØ· -->
    <table id="marks-table">
        <thead>
            <tr>
                <th>Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù…ØªØ­ØµÙ„ Ø¹Ù„ÙŠÙ‡Ø§</th>
                <th>Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„Ù‚Ø§Ø¹Ø¯ÙŠØ©</th>
                <th>Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªÙ†Ù‚ÙŠØ·</th>
            </tr>
        </thead>
        <tbody>
            <tr><td><input class="mark-input" data-max="5"></td><td>5</td><td>Ø§Ù„ØªØ­Ø¶ÙŠØ± Ø§Ù„ÙƒØªØ§Ø¨ÙŠ ÙˆØ§Ù„Ù…Ø§Ø¯ÙŠ</td></tr>
            <tr><td><input class="mark-input" data-max="4"></td><td>4</td><td>ØµÙŠØ§ØºØ© Ø§Ù„Ø£ØºØ±Ø§Ø¶ Ø§Ù„Ø¨ÙŠØ¯Ø§ØºÙˆØ¬ÙŠØ©</td></tr>
            <tr><td><input class="mark-input" data-max="4"></td><td>4</td><td>Ø§Ù„Ø®Ø·ÙˆØ§Øª Ø§Ù„Ø¨ÙŠØ¯Ø§ØºÙˆØ¬ÙŠØ©</td></tr>
            <tr><td><input class="mark-input" data-max="5"></td><td>5</td><td>Ø§Ù„ØªÙ†Ø´ÙŠØ· â€“ Ø§Ù„Ù‚Ø¯Ø±Ø§Øª</td></tr>
            <tr><td><input class="mark-input" data-max="5"></td><td>5</td><td>Ù†ÙˆØ¹ÙŠØ© Ø§Ù„Ø´Ø±ÙˆØ­Ø§Øª</td></tr>
            <tr><td><input class="mark-input" data-max="5"></td><td>5</td><td>Ø§Ù„ØªÙ†Ù‚ÙŠØ· Ø§Ù„ØªØ­Ù„ÙŠÙ„ÙŠ ÙˆØ§Ù„Ù…ÙˆØ¶ÙˆØ¹ÙŠ</td></tr>
            <tr><td><input class="mark-input" data-max="4"></td><td>4</td><td>Ø¥Ø®ØªÙŠØ§Ø± ÙˆØ¥Ø³ØªØ¹Ù…Ø§Ù„ Ø§Ù„ÙˆØ³Ø§Ø¦Ù„ Ø§Ù„Ø¨ÙŠØ¯Ø§ØºÙˆØ¬ÙŠØ©</td></tr>
            <tr><td><input class="mark-input" data-max="2"></td><td>2</td><td>ØªÙƒÙŠÙŠÙ Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„ØªÙƒÙˆÙŠÙ† Ùˆ ØªØ³ÙŠÙŠØ± Ø§Ù„ÙˆÙ‚Øª</td></tr>
            <tr><td><input class="mark-input" data-max="2"></td><td>2</td><td>ØªÙ†Ø¸ÙŠÙ… Ø§Ù„ØªØ¹Ù„ÙŠÙ…</td></tr>
            <tr><td><input class="mark-input" data-max="4"></td><td>4</td><td>ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø­ØµØ©</td></tr>
            <tr><td id="total-cell">0.00</td><td>40</td><td>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</td></tr>
        </tbody>
    </table>

    <!-- Ø§Ù„Ø£Ø²Ø±Ø§Ø± -->
    <div class="button-group">
        <button class="btn notes-btn" onclick="toggleNotes()">ğŸ“ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©</button>
        <button class="btn save-btn" onclick="saveData()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª</button>
        <button class="btn exit-btn" onclick="goBack()">â¬…ï¸ Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ PFP</button>
    </div>

    <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª -->
    <div id="notes-section">
        <h3>Ø£ÙƒØªØ¨ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø©:</h3>
        <textarea id="notes-text"></textarea><br>
        <button class="btn save-btn" onclick="saveNotes()">ğŸ’¾ Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª</button>
    </div>
</div>

<script>
// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙˆØªÙ„ÙˆÙŠÙ† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹
const markInputs = document.querySelectorAll(".mark-input");
const totalCell = document.getElementById("total-cell");

function updateTotal() {
    let total = 0;
    markInputs.forEach(input => {
        let val = parseFloat(input.value.replace(",", "."));
        let max = parseFloat(input.dataset.max);
        if (isNaN(val)) val = 0;
        if (val < 0 || val > max) {
            input.style.backgroundColor = "#FFB6C1";
        } else {
            input.style.backgroundColor = "white";
            total += val;
        }
    });

    totalCell.textContent = total.toFixed(2);
    if (total < 20) totalCell.style.backgroundColor = "#FF6347";
    else if (total >= 20 && total < 24) totalCell.style.backgroundColor = "#FFD700";
    else totalCell.style.backgroundColor = "#32CD32";
}

markInputs.forEach(input => {
    input.addEventListener("input", updateTotal);
});

// Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª
function toggleNotes() {
    const notes = document.getElementById("notes-section");
    notes.style.display = notes.style.display === "none" ? "block" : "none";
}

// Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (ØªØ­ØªØ§Ø¬ Ø§Ù„Ø±Ø¨Ø· Ù…Ø¹ Python WebChannel)
function saveData() {
    const lessonTitle = document.getElementById("lesson-title").value.trim();
    const marks = Array.from(markInputs).map(input => input.value.trim());
    const total = totalCell.textContent;
    const notes = document.getElementById("notes-text").value.trim();

    if (!lessonTitle || marks.includes("")) {
        alert("âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ù…Ù„Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸.");
        return;
    }

    const dataToSave = {
        lesson_title: lessonTitle,
        marks1: marks,
        total: total,
        notes: notes
    };

    if (window.bridge && window.bridge.save_PV1_2) {
        window.bridge.save_PV1_2(JSON.stringify(dataToSave));
        alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø¬Ø§Ø­ âœ…");
    } else {
        console.log("Data:", dataToSave);
        alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª (ÙˆØ¶Ø¹ ØªØ¬Ø±ÙŠØ¨ÙŠØŒ Ø¨Ø¯ÙˆÙ† Python).");
    }
}

// Ø­ÙØ¸ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª ÙÙ‚Ø·
function saveNotes() {
    toggleNotes();
    saveData();
}

// Ø§Ù„Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ PFP
function goBack() {
    if (window.bridge && window.bridge.open_PFP) {
        window.bridge.open_PFP();
    } else {
        alert("Ø¹ÙˆØ¯Ø© Ø¥Ù„Ù‰ PFP (ÙˆØ¶Ø¹ ØªØ¬Ø±ÙŠØ¨ÙŠ).");
    }
}
</script>
</body>
</html>
